<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAME</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@100;300;500;700;800&family=Quicksand:wght@300;400&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;1,100;1,200;1,300;1,400;1,500&display=swap" rel="stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
    <script type="text/javascript" src="fly.js"></script>
    

    
</head>
<body>
    <div class="main">
        <div class=play_left">
            <div class="container">
                <div class="title">
                    <p style="font-family:Jelantik"   class="animate_animated animate__backInLeft"  id="weirdtext">Welcome to</p>
                    <p style="font-family: Jelantik" class="animate__animated animate__bounceInDown" id="largeText">Memoryify</h2>
                </div>
            </div>

            <div class="buttons">
                <button value="PLAY" onclick="play(), mute(), change()" class="bubbly-button">
                    <span class="tooltip">Mute</span>
                    <audio id="audio" src="sounds_and_music/twinkles_cutted.mp3"></audio>
                    <i class="fa-solid fa-volume-xmark fa-bounce fa-2xl"></i>
                    <!--<i class="fa-solid fa-music fa-bounce fa-2xl" id="img2" onClick="chg(this.id)" style="color: #fefcdd; display:none"></i>-->
                </button>
                <button value="PLAY"  onclick="play(), changeCoordinates()", class="bubbly-button">
                    <!--<input type="button" value="PLAY" onclick="play()" class="bubbly-button">-->
                        <span class="tooltip">Play</span>
                        <audio id="audio" src="sounds_and_music/twinkles_cutted.mp3"></audio>
                        <i class="fa-solid fa-face-smile fa-bounce fa-2xl"></i>
                        <!--<i class="fa-solid fa-house fa-bounce fa-2xl" style="color: #f2f7b7;"></i>-->
                </button>
                <button value="PLAY" onclick="play(), changeDayToNight()" class="bubbly-button" >
                    <span class="tooltip">Night</span>
                    <audio id="audio" src="sounds_and_music/twinkles_cutted.mp3"></audio>
                    <i class="fa-solid fa-moon fa-bounce fa-2xl"></i>
                    <!--<<i class="fa-solid fa-sun fa-bounce fa-2xl" style="color: #f8fadb;"></i>"></i>-->
                </button>
              
                <button value="PLAY" onclick="play()" class="bubbly-button" id="scoreBtn">
                    <span class="tooltip">Scores</span>
                    <audio id="audio" src="sounds_and_music/twinkles_cutted.mp3"></audio>
                    <i class="fa-solid fa-star fa-bounce fa-2xl"></i>
                    <!--<<i class="fa-solid fa-sun fa-bounce fa-2xl" style="color: #f8fadb;"></i>"></i>-->
                    </button>
                

                <button value="PLAY" onclick="play()" class="bubbly-button" id="myBtn">
                    <span class="tooltip">Info</span>
                    <audio id="audio" src="sounds_and_music/twinkles_cutted.mp3"></audio>
                    <i class="fa-solid fa-info fa-bounce fa-2xl"></i>
                    <a href="#ex1" rel="modal:open"></a>
                    <!--<<i class="fa-solid fa-sun fa-bounce fa-2xl" style="color: #f8fadb;"></i>"></i>-->
                </button>
            </div>
            <div id="myModal" class="modal">
                <div class="modal-content">
                    <div class="modal-body">
                        <span class="close">&times;</span>
                        <p style="font-family: Quicksand;">Hi Friend!!!<br>
                                                    So here is some info for you to read before you start your journey with Memoryify.
                                                    This game was created to test your ability to retain information. Play it to improve your 
                                                    attention, concentration, and focus. To start please proceed to smily button. Hope you'll enjoy it!<br>
                        </p>
                    </div>
                </div>
            </div>
        

            <div id="myModal2" class="modal2">
                <div class="modal-content2">
                <div class="modal-body2">
                    <span class="close2">&times;</span>
                        <table class="zigzag" style="border-collapse:separate; border-spacing:.25em 1em;transform:rotate(6deg); border:beige 2px solid; border-radius:5px">
                            <thead>
                                <tr style="background-color: darkgray;transform:rotate(2deg); border-radius: 5px;">
                                    <th class="header" style="width:70%"; border-radius: 5px;>Player</th>
                                    <th class="header" style="width:10%">Score</th>
                                    <th class="header" style="width:20%">Date</th>
                                    
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background-color: lightgrey;transform:rotate(-2deg)">
                                    <td>aaaa</td>
                                    <td>bbbb</td>
                                    <td>cccc</td>
                                    
                                </tr>
                                <tr  style="background-color: lightgrey;transform:rotate(2deg)">
                                    <td>aaa</td>
                                    <td>bbb</td>
                                    <td>ccc</td>
                                </tr>
                                <tr  style="background-color: lightgrey;transform:rotate(-2deg)">
                                    <td>aaa</td>
                                    <td>bbb</td>
                                    <td>ccc</td>
                                </tr>
                                <tr style="background-color: lightgrey;transform:rotate(2deg)">
                                    <td>aaa</td>
                                    <td>bbb</td>
                                    <td>ccc</td>
                                </tr>
                                <tr style="background-color: lightgrey;transform:rotate(-2deg)">
                                    <td>aaa</td>
                                    <td>bbb</td>
                                    <td>ccc</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>



            <audio id="background_audio" autoplay loop>
                <source src="sounds_and_music/sonic-wave-134902.mp3"/>
            </audio>
        </div><!--the end of play_left page-->
        <div class="play_right" id="right" style="display:none;">
            <div class="container2">
               
            
                <section class="score-panel">
                  
                    <ul id="star-rating" class="star-rating">
                        <li class="star"><i class="fa fa-star"></i></li>
                        <li class="star"><i class="fa fa-star"></i></li>
                        <li class="star"><i class="fa fa-star"></i></li>
                    </ul>
                    <span class="moves-counter">0</span> Moves
                    <div class="timer-container">
                        <span class="timer"><i class="fa fa-hourglass-start"></i> Timer: 00:00</span>
                    </div>
                    <div class="reset">
                        <button class="btn reset-btn" style="width:100px; height:40px">Reset<i class="fa fa-repeat"></i></button>
                    </div>
                </section>
            
                <!-- Modal -->
                <section class="win-game-modal">
                    <div id="modal_game" class="modal_game">
                        <!-- Modal content -->
                        <div class="modalgamecontent">
                            <span class="close">&times;</span>
                            <h2>Congratulations!</h2>
                            <p>You have won the game and found all 8 pairs of cards.</p>
                            <img class="modal-img" src="https://github.com/FoxyStoat/memory-game/blob/master/assets/img/Vault-Boy-Thumb-Up.jpg?raw=true" alt="Vault boy giving the thumbs up from the game fall out">
                            <button class="btn play-again-btn">Play Again?</button>
                        </div>
                    </div>
                </section>
            
                <ul class="deck"></ul>
            </div>
            
        </div>
    </div>
    <script type="text/javascript" src="fly.js"></script>
   
    <script>
        
        

        let modal = document.getElementById("myModal");
        let btn = document.getElementById("myBtn");
        let span = document.getElementsByClassName("close")[0];
        btn.onclick = function() {
        modal.style.display = "block";
        }
        span.onclick = function() {
        modal.style.display = "none";
        }
        window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
            }
        }

        let modal2 = document.getElementById("myModal2");
        let btn2 = document.getElementById("scoreBtn");
        let span2 = document.getElementsByClassName("close2")[0];
        btn2.onclick = function() {
        modal2.style.display = "block";
        }

        span2.onclick = function() {
        modal2.style.display = "none";
        }
         window.onclick = function(event2) {
        if (event2.target == modal2) {
            modal2.style.display = "none";
            }
        }

        
        function change(){
            const musicOn = document.getElementsByTagName("i");
            const toolTips = document.querySelectorAll("span")
            if(musicOn[0].getAttribute("class")=== "fa-solid fa-volume-xmark fa-bounce fa-2xl" ){
                musicOn[0].removeAttribute("class");
                musicOn[0].setAttribute("class", "fa-solid fa-music fa-bounce fa-2xl");
                toolTips[0].innerHTML = "SoundOn"
            } else {
                musicOn[0].removeAttribute("class");
                musicOn[0].setAttribute("class", "fa-solid fa-volume-xmark fa-bounce fa-2xl")
                toolTips[0].innerHTML = "Mute"
            }
        };
        
        
        const main = document.getElementsByClassName("main")
        console.log(main);


        function changeCoordinates(){
            const smiley = document.getElementsByTagName("i");
            const toolTips = document.querySelectorAll("span");
            const buttonToREmove = document.querySelectorAll("button");
            const mainDiv = document.getElementsByClassName("main");
            let myBlock = document.getElementById("right");
            if(smiley[1].getAttribute("class")==="fa-solid fa-face-smile fa-bounce fa-2xl"){
                smiley[1].removeAttribute("class");
                smiley[1].setAttribute("class", "fa-solid fa-house fa-bounce fa-2xl");
                document.querySelector(".container").style.marginBottom = "50px"
                document.querySelector(".container").style.textAlign = "left";
                document.querySelector(".container").style.justifyContent = "flex-start"
                document.querySelector(".container").style.marginLeft = "0px";
                document.querySelector(".container").style.marginTop = "50px";
                document.querySelector("#weirdtext").style.fontSize = "100px";
                document.querySelector("#largeText").style.fontSize = "110px";
                document.querySelector(".buttons").style.justifyContent= "left";
                document.querySelector(".buttons").style.marginLeft = "0px";
                buttonToREmove[3].style.visibility = "hidden";
                buttonToREmove[4].style.visibility = "hidden"
                toolTips[1].innerHTML="Home";
                
                myBlock.style.display = "block";
                
                document.querySelector(".main").style.flexDirection="row"
                document.querySelector(".main").style.justifyContent = "center"
               document.querySelector(".main").style.marginTop = "50px"
                

            }else{
                smiley[1].removeAttribute("class");
                smiley[1].setAttribute("class", "fa-solid fa-face-smile fa-bounce fa-2xl");
                document.querySelector(".container").style.justifyContent = "center";
                document.querySelector(".container").style.textAlign = "center";
                document.querySelector(".buttons").style.justifyContent= "center";
                document.querySelector("#weirdtext").style.fontSize = "100px";
                document.querySelector("#largeText").style.fontSize = "180px";
                document.querySelector(".container").style.marginTop = "150px"
                toolTips[1].innerHTML="Play";
                buttonToREmove[3].style.visibility = "visible";
                buttonToREmove[4].style.visibility = "visible";
                myBlock.style.display = "none"

            }

        }

        function changeDayToNight(){
            const dayOrNight = document.getElementsByTagName("i");
            const toolTips = document.querySelectorAll("span")

            if(dayOrNight[2].getAttribute("class")=== "fa-solid fa-moon fa-bounce fa-2xl"){
                dayOrNight[2].removeAttribute("class");
                dayOrNight[2].setAttribute("class", "fa-solid fa-sun fa-bounce fa-2xl")
                document.querySelector("body").style.backgroundImage ="url(images/night.jpg)";
                document.querySelector("p").style.color="#ffd8f7";
                document.querySelector("p").style.textShadow="2px 20px 25px #f0799d";
                document.querySelector("#largeText").style.color="#ffd8f7";
                document.querySelector("#largeText").style.textShadow="2px 20px 25px #f0799d";
                
                toolTips[2].innerHTML = "Light"
                
            } else {
                dayOrNight[2].removeAttribute("class");
                dayOrNight[2].setAttribute("class", "fa-solid fa-moon fa-bounce fa-2xl");
                document.querySelector("body").style.backgroundImage = "url(images/gradient-forest-landscape.jpg.avif)";
                document.querySelector("p").style.color="#F04A00";
                document.querySelector("p").style.textShadow="2px 20px 25px lightyellow";
                document.querySelector("#largeText").style.color="#F04A00";
                document.querySelector("#largeText").style.textShadow="2px 20px 25px lightyellow";
                
                toolTips[2].innerHTML = "Dark"
            }
        };

        function play() {
         let audio = document.getElementById("audio");
            audio.play();
        };
        

        function mute(){
              if(document.getElementById('background_audio').muted == false){

                document.getElementById('background_audio').muted = true;
                
              } else {
                document.getElementById('background_audio').muted = false;
               
        }
    }


    let animateButton = function(e) {
        e.preventDefault;
        e.target.classList.remove('animate');
        e.target.classList.add('animate');
        setTimeout(function(){
        e.target.classList.remove('animate');
        },700);
    };

    let bubblyButtons = document.getElementsByClassName("bubbly-button");

    for (let i = 0; i < bubblyButtons.length; i++) {
        bubblyButtons[i].addEventListener('click', animateButton, false);
    }



// Array of Deck of Card Images
const deckCards = ["icons/bird.png", "icons/bird.png", "icons/flower.png", "icons/flower.png", "icons/forest.png", "icons/forest.png", "icons/hamster.png", "icons/hamster.png", "icons/sunny.png", "icons/sunny.png", "icons/heart.png", "icons/heart.png", "icons/bear.png", "icons/bear.png", "icons/butterfly.png", "icons/butterfly.png"];

// Global Arrays
// Access the <ul> with class of .deck
const deck = document.querySelector(".deck");
// Create an empty array to store the opened cards
let opened = [];
// Create an empty array to store the matched cards
let matched = [];

// Access the modal
const modal_game = document.getElementById("modal");

// Access the reset button
const reset = document.querySelector(".reset-btn");
// Access the play again button
const playAgain = document.querySelector(".play-again-btn");

// Select the class moves-counter and change it's HTML  
const movesCount = document.querySelector(".moves-counter");
// Create variable for moves counter, start the count at zero
let moves = 0;

// Access the <ul> element for the star rating section and then the <li> elements within it
const star = document.getElementById("star-rating").querySelectorAll(".star");
// Variable to keep track of how many stars are left
let starCount = 3;

// Get the span tag for the timer.
const timeCounter = document.querySelector(".timer");
// To use this variable to stop the time started in timer
let time;
// Create variables for time count, start all at zero
let minutes = 0;
let seconds = 0;
// For use in the click card event listener
let timeStart = false;

// Shuffle function from http://stackoverflow.com/a/2450976
function shuffle(array) {
  let currentIndex = array.length, temporaryValue, randomIndex;

  while (currentIndex !== 0) {
      randomIndex = Math.floor(Math.random() * currentIndex);
      currentIndex -= 1;
      temporaryValue = array[currentIndex];
      array[currentIndex] = array[randomIndex];
      array[randomIndex] = temporaryValue;
  }
  return array;
}

/*
Start Game: Shuffle the deck, create <li> tags and <img> 
tags and append to the deck <ul> with the new shuffled content
*/
function startGame() {
	// Invoke shuffle function and store in variable
	const shuffledDeck = shuffle(deckCards); 
	// Iterate over deck of cards array
	for (let i = 0; i < shuffledDeck.length; i++) {
		// Create the <li> tags
		const liTag = document.createElement('LI');
		// Give <li> class of card
		liTag.classList.add('card');
		// Create the <img> tags
		const addImage = document.createElement("IMG");
		// Append <img> to <li>
		liTag.appendChild(addImage);
		// Set the img src path with the shuffled deck
		addImage.setAttribute("src",shuffledDeck[i] + "?raw=true");
		// Add an alt tag to the image
		addImage.setAttribute("alt", "random pictures");
		// Update the new <li> to the deck <ul>
		deck.appendChild(liTag);
	}
}

startGame();

/*
Remove all child nodes from the deck <li> tags and
<img> tags.  To be called in set everything function only
*/
function removeCard() {
	// As long as <ul> deck has a child node, remove it
	while (deck.hasChildNodes()) {
		deck.removeChild(deck.firstChild);
	}
}

/*
Update the timer in the HTML for minutes and seconds
This timer() function is invoked in the event listener
on the first card click
Used: https://www.w3schools.com/js/js_timing.asp
*/
function timer() {
	// Update the count every 1 second
	time = setInterval(function() {
		seconds++;
			if (seconds === 60) {
				minutes++;
				seconds = 0;
			}
		// Update the timer in HTML with the time it takes the user to play the game
		timeCounter.innerHTML = "<i class='fa fa-hourglass-start'></i>" + " Timer: " + minutes + " Mins " + seconds + " Secs" ;
	}, 1000);
}

/*
Stop the timer once the user has matched
all 16 cards, total of 8 pairs
Used: https://www.w3schools.com/js/js_timing.asp
*/
function stopTime() {
	clearInterval(time);
}

/*
Reset all global variables and the content of HTML elements
timer, stars, moves, and the moves and timer inner HTML
*/
function resetEverything() {
	// Stop time, reset the minutes and seconds update the time inner HTML
	stopTime();
	timeStart = false;
	seconds = 0;
	minutes = 0;
	timeCounter.innerHTML = "<i class='fa fa-hourglass-start'></i>" + " Timer: 00:00";
	// Reset star count and the add the class back to show stars again
	star[1].firstElementChild.classList.add("fa-star");
	star[2].firstElementChild.classList.add("fa-star");
	starCount = 3;
	// Reset moves count and reset its inner HTML
	moves = 0;
	movesCount.innerHTML = 0;
	// Clear both arrays that hold the opened and matched cards
	matched = [];
	opened = [];
	// Clear the deck
	removeCard();
	// Create a new deck
	startGame();
}

/*
Increment the moves counter.  To be called at each
comparison for every two cards compared add one to the count
*/
function movesCounter() {
	// Update the html for the moves counter
	movesCount.innerHTML ++;
	// Keep track of the number of moves for every pair checked
	moves ++;
}

/*
Update the star rating.  Depending on the number of
moves the user completes the game, the stars will decrease
with the more moves the user takes.
*/
function starRating() {
	if (moves === 14) {
		// First element child is the <i> within the <li>
		star[2].firstElementChild.classList.remove("fa-star");
		starCount--;
	}
	if (moves === 18) {
		star[1].firstElementChild.classList.remove("fa-star");
		starCount--;
	}
}

/*
Compare two cards to see if they match or not
*/
function compareTwo() {
	// When there are 2 cards in the opened array
	if (opened.length === 2) {
  		// Disable any further mouse clicks on other cards
  		document.body.style.pointerEvents = "none";
  }
	// Compare the two images src
	if (opened.length === 2 && opened[0].src === opened[1].src) {
		// If matched call match()
		match();
		// console.log("It's a Match!");
	} else if (opened.length === 2 && opened[0].src != opened[1].src) {
		// If No match call noMatch()
		noMatch();
		// console.log("NO Match!");
	}
}

/*
If the two cards match, keep the cards open and
apply class of match
*/ 
function match() {
	/* Access the two cards in opened array and add
	the class of match to the imgages parent: the <li> tag
	*/
	setTimeout(function() {
		opened[0].parentElement.classList.add("match");
		opened[1].parentElement.classList.add("match");
		// Push the matched cards to the matched array
		matched.push(...opened);
		// Allow for further mouse clicks on cards
		document.body.style.pointerEvents = "auto";
		// Check to see if the game has been won with all 8 pairs
		winGame();
		// Clear the opened array
		opened = [];
	}, 600);
	// Call movesCounter to increment by one
	movesCounter();
	starRating();
}

/*
If the two cards do not match, remove the cards
from the opened array and flip the cards back over by
removing the flip class.
*/
function noMatch() {
	/* After 700 miliseconds the two cards open will have
	the class of flip removed from the images parent element <li>*/
	setTimeout(function() {
		// Remove class flip on images parent element
		opened[0].parentElement.classList.remove("flip");
		opened[1].parentElement.classList.remove("flip");
		// Allow further mouse clicks on cards
		document.body.style.pointerEvents = "auto";
		// Remove the cards from opened array
		opened = [];
	}, 700);
	// Call movesCounter to increment by one
	movesCounter();
	starRating();
}

/*
Get stats on the time, how many moves, and star rating
for the end game and update the modal with these stats
*/
function AddStats() {
	// Access the modal content div
	const stats = document.querySelector(".modal-content");
	// Create three different paragraphs
	for (let i = 1; i <= 3; i++) {
		// Create a new Paragraph
		const statsElement = document.createElement("p");
		// Add a class to the new Paragraph
		statsElement.classList.add("stats");
		// Add the new created <p> tag to the modal content
		stats.appendChild(statsElement);
	}
	// Select all p tags with the class of stats and update the content
	let p = stats.querySelectorAll("p.stats");
			// Set the new <p> to have the content of stats (time, moves and star rating)
		p[0].innerHTML = "Time to complete: " + minutes + " Minutes and " + seconds + " Seconds";
		p[1].innerHTML = "Moves Taken: " + moves;
		p[2].innerHTML = "Your Star Rating is: " + starCount + " out of 3";
}

/*
Display the modal on winning the game
Help with the modal from:
https://www.w3schools.com/howto/howto_css_modals.asp
*/
function displayModal() {
// Access the modal <span> element (x) that closes the modal
const modalClose = document.getElementsByClassName("close")[0];
	// When the game is won set modal to display block to show it
	modal_game_.style.display= "block";

	// When the user clicks on <span> (x), close the modal
	modalClose.onclick = function() {
		modal.style.display = "none";
	};
// When the user clicks anywhere outside of the modal, close it
	window.onclick = function(event) {
		if (event.target == modal) {
			modal_game.style.display = "none";
		}
	};
}

/*
Check the length of the matched array and if there
are 8 pairs 16 cards all together then the game is won.
Stop the timer update the modal with stats and show the modal
*/
function winGame() {
	if (matched.length === 16) {
		stopTime();
		AddStats();
		displayModal();
	}
}

/*----------------------------------  
Main Event Listener
------------------------------------*/
/*
Event Listener if a card <li> is clicked
call flipCard()
*/
deck.addEventListener("click", function(evt) {
	if (evt.target.nodeName === "LI") {
		// To console if I was clicking the correct element 
		console.log(evt.target.nodeName + " Was clicked");
		// Start the timer after the first click of one card
	// Executes the timer() function
		if (timeStart === false) {
			timeStart = true; 
			timer();
		}
		// Call flipCard() function
		flipCard();
	}

	//Flip the card and display cards img
	function flipCard() {
		// When <li> is clicked add the class .flip to show img
		evt.target.classList.add("flip");
		// Call addToOpened() function
		addToOpened();
	}
	 
	//Add the fliped cards to the empty array of opened
	function addToOpened() {
		/* If the opened array has zero or one other img push another 
		img into the array so we can compare these two to be matched
		*/
		if (opened.length === 0 || opened.length === 1) {
			// Push that img to opened array
			opened.push(evt.target.firstElementChild);
		}
		// Call compareTwo() function
		compareTwo();
	}
}); //Event Listener

/*----------------------------------  
Restart Buttons
------------------------------------*/
/*
Event Listener to listen for a click on the reset
button, once clicked call resetEverything()
*/
reset.addEventListener('click', resetEverything);

/*
Event Listener to listen for a click on the play
again button, once clicked call resetEverything()
*/
playAgain.addEventListener('click',function() {
	modal_game.style.display = "none";
	resetEverything();
});

        

        </script>
        
    </body>
    </html>